# backend/Dockerfile

FROM python:3.11-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /backend/gunicorn/

# üîß –°–∏—Å—Ç–µ–º–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
RUN apt-get update && apt-get install -y \
    build-essential \
    libpq-dev \
    netcat-openbsd \
    gcc && \
    pip install --upgrade pip

# üîß –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python-–∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
COPY requirements.txt .
RUN pip install -r requirements.txt

# üîß –ö–æ–ø—ñ—é—î–º–æ –≤–µ—Å—å –∫–æ–¥
COPY . .

# üîß –ö–æ–ø—ñ—é—î–º–æ Gunicorn-–∫–æ–Ω—Ñ—ñ–≥ (—è–∫—â–æ –≤—ñ–Ω –æ–∫—Ä–µ–º–∏–π)
COPY gunicorn/gunicorn.conf.py /app/gunicorn/gunicorn.conf.py

# üîß –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Gunicorn
CMD ["gunicorn", "--config", "gunicorn/gunicorn.conf.py", "config.wsgi:application"]
